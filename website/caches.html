---
layout: default
---

<h2>Caches</h2>

<p>Caches cache generated images on the server. Caches are pluggable, to enable different caching mechanisms. (Currently, <a href="#FilesystemCache">FilesystemCache</a> is the only implementation.) Expired files are replaced the next time they are requested.</p>

<p>Currently, requests for full-sized, un-altered source images are not cached, and are instead streamed through with no processing.</p>

<h3 id="FilesystemCache">FilesystemCache</h3>

<p>FilesystemCache caches generated images and (parts of) information requests into a filesystem directory. The location of this directory is configurable, as is the "time-to-live" of the cache files, with the following options:</p>

<dl>
  <dt><code>FilesystemCache.pathname</code></dt>
  <dd>Absolute path of the folder in which cached images and information responses will be stored.</dd>
  <dt><code>FilesystemCache.ttl_seconds</code></dt>
  <dd>Time-to-live of the cached images and information responses, in seconds.</dd>
</dl>

<h3 id="JdbcCache">JdbcCache</h3>

<p>JdbcCache caches generated images and (parts of) information requests into tables in a relational database (RDBMS). This cache can be configured with the following options:</p>

<dl>
  <dt><code>JdbcCache.connection_string</code></dt>
  <dd>A valid JDBC connection string; for example, <code>jdbc:postgresql://localhost:5432/mydatabase</code>.</dd>
  <dt><code>JdbcCache.user</code></dt>
  <dd>User to connect to the database as.</dd>
  <dt><code>JdbcCache.password</code></dt>
  <dd>Password to use when connecting to the database. Can be left blank if not needed.</dd>
  <dt><code>JdbcCache.image_table</code></dt>
  <dd>The table in which to cache images. This will be created automatically.</dd>
  <dt><code>JdbcCache.info_table</code></dt>
  <dd>The table in which to cache information responses. This will be created automatically.</dd>
  <dt><code>JdbcCache.ttl_seconds</code></dt>
  <dd>Time-to-live of the cached images and information responses, in seconds.</dd>
</dl>

<p><em>Note: JdbcCache has been tested with PostgreSQL 9.4 and H2 1.4. Other databases may work, but are untested. In particular, the database needs to support <code>CREATE TABLE IF NOT EXISTS</code> syntax, which in the case of PostgreSQL, arrived in version 9.1.</em></p>

<h3 id="Flushing">Flushing the Cache</h3>

<p>To flush expired images only, start Cantaloupe with the <code>-Dcantaloupe.cache.flush_expired</code> option.</p>

<p>To flush all images, start Cantaloupe with the <code>-Dcantaloupe.cache.flush</code> option.</p>

<h3 id="Considerations">Considerations</h3>

<p>Caching is tremendously effective at improving performance, but it does not quite reduce load to zero. Consider a caching reverse proxy if massive traffic is anticipated.</p>

<p>Cantaloupe does not cache entire information response representations &mdash; only image dimensions, which are the only expensive part to generate. This means it is possible to change other variables that might affect the contents of the representation (like processors) without having to flush the cache.</p>

<p>Cantaloupe caches response representations only --  not the entire request process. Requests are validated and resources are looked up before cached responses are returned. This precludes returning a cached resource representation when the underlying resource has actually gone missing, but also impairs response times by typically several tens of milliseconds.</p>
